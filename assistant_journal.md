# Журнал работ

- 2026-01-19 16:13 — Запрос от пользователя: вести журнал выполненных действий.
- 2026-01-19 16:13 — Зафиксирована проблема: окно сообщений не смещается корректно при открытии клавиатуры.
- 2026-01-19 16:20 — Принято: полностью перестроить чат на overlay input bar, считать отступы IME/NavBar вручную.
- 2026-01-19 16:20 — Исправление: удалена проверка "голос недоступен" (запуск распознавания даже если isRecognitionAvailable=false).
- 2026-01-19 16:28 — Навигация: убран общий padding у NavHost, для чата передан bottomBarPadding.
- 2026-01-19 16:28 — Чат: учтен bottomBarPadding в расчете нижнего отступа (IME/NAV/BottomBar).
- 2026-01-19 16:36 — Голос: добавлен fallback через RecognizerIntent при недоступности SpeechRecognizer.
- 2026-01-19 16:36 — Документы: добавлен авто-поллинг статуса каждые 5s + кнопка ручного обновления.
- 2026-01-19 16:42 — Чат: добавлено форматирование текста без спецсимволов, увеличена ширина пузырей, улучшен контраст панели ввода.
- 2026-01-19 16:45 — Чат: убрано Markdown-оглавление (## и т.п.) из текста сообщений.
- 2026-01-19 16:55 — Чаты: добавлены создание/переключение/удаление через список чатов и сохранение conversation_id.
- 2026-01-19 17:08 — Чаты: добавлен API создания чата, синхронизация сообщений, список чатов в bottom sheet.
- 2026-01-20 10:15 — Voice: removed runBlocking in recognizer callbacks, added main-scope emission and scope cancel on destroy to prevent crashes.
- 2026-01-20 10:25 — Chat UI: removed debug overlay, centered input row items, resized chat/voice/send buttons.
- 2026-01-20 10:26 — Chats: added local fallback for create/delete and guard on switching.
- 2026-01-20 10:40 — Documents UI: list moved to top, upload controls to bottom, compact spacing, renamed upload button.
- 2026-01-20 10:41 — Documents UX: local rename, simplified file type labels, new file-type icons/colors, ready badge timing window.
- 2026-01-20 11:05 — Chat: fixed duplicate LazyColumn keys with indexed keys + assistant message upsert.
- 2026-01-20 11:06 — Voice: added extra safeguards around recognizer creation/start and destroyed state.
- 2026-01-20 11:20 — Added in-app crash logger (store last crash, view/copy/clear in Settings).
- 2026-01-20 11:32 — Added safe voice mode + in-app voice event log for Oppo device shutdown cases.
- 2026-01-20 11:45 — Forced safe voice on OPPO/Realme/OnePlus, added intent availability check and event logging.
- 2026-01-20 11:58 — Deferred voice start after permission grant to avoid Oppo crash.
- 2026-01-20 12:10 — Voice: switched mic to server-side recording+transcription (MediaRecorder -> /voice/transcribe).
- 2026-01-20 12:22 — Added voice auto-send toggle; when off, transcription fills input.
- 2026-01-20 12:40 — Chat: added AI provider fields and provider dot indicator in chat bubbles.
- 2026-01-20 12:55 — Replaced app launcher foreground icon with provided icon.png (drawable ic_launcher_foreground.png).
- 2026-01-20 13:20 — Voice input: added haptic feedback (start/stop/error) and visible recording indicator; added VIBRATE permission.
- 2026-01-21 14:05 — Chat: fixed messages endpoint parsing (list response) and refreshed chat list on open; scoped ChatViewModel to Main graph to preserve history across tabs; added saveable chat list state.
- 2026-01-21 14:05 — Voice: added immediate haptic feedback on mic press and stronger fallback using View.performHapticFeedback.
- 2026-01-21 14:05 — App icon: replaced ic_launcher_foreground with icon.png.
- 2026-01-21 14:40 — Bottom navigation redesigned for readability (surfaceContainer background, outlined/filled icons, stronger contrast).
- 2026-01-21 14:40 — Documents screen redesigned: list-first layout, bottom action panel, removed view icon, compact list, local rename UI.
- 2026-01-21 15:20 — Chat UX: grouped bubbles, send status (sending/failed + retry), skeleton loading when syncing.
- 2026-01-21 15:20 — Documents UX: filters + sorting chips, swipe-to-delete, skeleton loading while fetching.
- 2026-01-21 16:10 — Chat UI: removed greeting card, compact input bar, smaller message text.
- 2026-01-21 16:10 — Bottom nav: reduced height and label size for compactness.
- 2026-01-21 16:10 — Auth: added imePadding to avoid keyboard covering inputs.
- 2026-01-21 17:00 — Dashboard: added API/client/repository, ViewModel/state, and full Compose UI with widgets and pull-to-refresh.
- 2026-01-21 17:20 — Dashboard: fixed deprecated APIs (progress lambda, AutoMirrored chat icon).
- 2026-01-21 17:20 — Added FRONT_ARCHITECTURE.md with frontend structure overview.
- 2026-01-21 17:45 — Chat UI: removed sending animation under user messages; kept only agent typing indicator and retry on failure.
- 2026-01-21 17:45 — Chat layout: list bottom padding now uses nav bar only to eliminate IME gap; input bar handles IME padding.
- 2026-01-21 17:50 — Built debug APK after chat animation + keyboard inset fixes.
- 2026-01-22 12:05 — Chat scroll: stable message keys, auto-scroll only when at bottom or user sends, and jump to latest when user starts typing while scrolled up.
- 2026-01-22 12:15 — Chat scroll: removed auto-jump on typing; now return to latest only after sending.
